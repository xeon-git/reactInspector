(()=>{"use strict";const e=(t,{path:o="",indexPath:n="",depth:c=0,maxDepth:r=1/0,visited:l=new Set,callback:a=()=>{}})=>{if(l.has(t)||c>r||"object"!=typeof t||null===t)return;l.add(t);let d=0;for(let i in t){const p=t[i];if("object"==typeof p&&null!==p){const t=o?`${o}.${i}`:i,h=n?`${n}.${d}`:`${d}`;a(p,i,t,h,c),e(p,{path:t,indexPath:h,depth:c+1,maxDepth:r,visited:l,callback:a})}d++}},t=(t,o)=>{let n=[];const c=document.getElementById("index-path-checkbox").checked,l=parseInt(o)||1/0,a=document.getElementById("search-by-name-checkbox").checked,d=document.getElementById("search-by-value-checkbox").checked;!a&&!d||""!==t?(document.getElementById("search-by-name-checkbox").checked&&(n=((t,o)=>{if(/^\d+(\.\d+)*$/.test(t)){const e=((e,t)=>{const o=t.split(".");let n=e;for(let e=0;e<o.length;e++){if(void 0===n)return null;const t=parseInt(o[e],10),c=Object.keys(n);if(isNaN(t)||t<0||t>=c.length)return null;n=n[c[t]]}return n})(root,t);return e?[{value:e,path:t,indexPath:t}]:[]}return((t,o,n=1/0,c=new Set,r=0)=>{const l=[];return e(t,{path:"",indexPath:"",depth:r,maxDepth:n,visited:c,callback:(e,t,n,c,r)=>{(n.includes(o)||t.includes(o))&&l.push({name:t,value:e,path:n,indexPath:c})}}),l})(root,t,o)})(t,l)),document.getElementById("search-by-value-checkbox").checked&&(n=n.concat(((t,o)=>{const n=isNaN(t)?t:Number(t);return((t,o,n=1/0,c=new Set,r=0)=>{const l=[];return e(t,{path:"",indexPath:"",depth:r,maxDepth:n,visited:c,callback:(e,t,n,c,r)=>{for(let t in e)if(e[t]===o){l.push({value:e,path:n,indexPath:c});break}}}),l})(root,n,o)})(t,l))),document.getElementById("display-all-components-checkbox").checked&&(n=(t=>((t,o=new Set,n=1/0,c=0)=>{const r=[],l=new Set;return e(t,{path:"",indexPath:"",depth:c,maxDepth:n,visited:o,callback:(e,t,o,n,c)=>{if(e?.constructor?.$metadata$?.simpleName){const t=e.constructor.$metadata$.simpleName;l.has(t)||(r.push({name:t,value:e,path:o,indexPath:n}),l.add(t))}}}),r})(root,new Set,t))(l)),n.length>0?((e,t)=>{e.forEach(((e,o)=>{const n=e.name||e.path.split(".").pop()||"компонент без имени";console.groupCollapsed(`%cкомпонент ${o+1}: ${n}`,"color: #9acd32; font-weight: bold;"),e.path&&console.log(`%cименной путь: %c${e.path}`,"color: #87cefa; font-weight: bold;","color: #ffffff;"),t&&e.indexPath&&console.log(`%cпуть из индексов: %c${e.indexPath}`,"color: #20B2AA; font-weight: bold;","color: #ffffff;"),console.log("%cзначение:","color: #ffa07a; font-weight: bold;",e.value),console.groupEnd()}))})(n,c):console.log(`%cкомпонент "${t}" не найден`,"color: #ff6347; font-weight: bold;"),r()):console.log("%cвведи корректный путь или значение для поиска","color: #ff6347; font-weight: bold;")};let o=!1;const n=()=>{o=!0,document.pointerLockElement&&document.exitPointerLock();const e=document.createElement("div");e.id="search-menu-background",Object.assign(e.style,{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(10px)",zIndex:"1000",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,cursor:"default"});const n=document.createElement("div");n.id="menu-container",n.tabIndex=0,n.focus(),n.style.cursor="default";const a=document.createElement("h2");a.id="menu-header",a.innerText="React Inspector";const d=document.createElement("div");d.id="menu-content";const i=document.createElement("input");i.id="menu-input",i.type="text",i.placeholder="введи именной путь, индексный или же значение";const p=document.createElement("input");p.id="menu-depth-input",p.type="number",p.placeholder="глубина",p.value=1/0,p.addEventListener("input",(()=>{p.value=p.value.replace(/[^0-9]/g,""),""===p.value&&(p.value=1/0)})),d.appendChild(i),d.appendChild(p);const h=document.createElement("div");h.id="menu-checkbox-container";const s=c("search-by-name-checkbox","комбинированный поиск");s.querySelector("input").checked=!0;const u=c("search-by-value-checkbox","поиск по значениям"),m=c("display-all-components-checkbox","вывод текущего древа"),b=c("index-path-checkbox","отображение индексов");h.appendChild(s),h.appendChild(u),h.appendChild(m),h.appendChild(b);const y=document.createElement("div");y.className="footer";const f=document.createElement("button");f.id="menu-search-button",f.innerText="поиск",f.addEventListener("click",(()=>t(i.value.trim(),p.value))),y.appendChild(f),n.appendChild(a),n.appendChild(d),n.appendChild(h),n.appendChild(y),e.appendChild(n),document.body.appendChild(e),requestAnimationFrame((()=>{e.style.opacity=1,n.focus(),i.focus(),document.addEventListener("keydown",l,!0),document.body.style.cursor="default",n.style.cursor="default",i.style.cursor="text"})),e.addEventListener("click",(t=>{t.target===e&&r()}));const g=document.querySelectorAll('#menu-checkbox-container input[type="checkbox"]');g.forEach((e=>{e.addEventListener("change",(function(){"display-all-components-checkbox"===this.id&&this.checked?(i.value="",i.disabled=!0):i.disabled=!1,Array.from(g).some((e=>e.checked&&"index-path-checkbox"!==e.id))||(this.checked=!0),"index-path-checkbox"!==this.id&&this.checked&&g.forEach((e=>{e!==this&&"index-path-checkbox"!==e.id&&(e.checked=!1)}))}))}))},c=(e,t)=>{const o=document.createElement("div");o.className="menu-checkbox-wrapper";const n=document.createElement("input");n.id=e,n.type="checkbox";const c=document.createElement("label");c.htmlFor=e;const r=document.createElement("span");return r.innerText=t,o.appendChild(r),o.appendChild(n),o.appendChild(c),o},r=()=>{const e=document.getElementById("search-menu-background");e&&e.parentNode===document.body&&(e.classList.add("fadeOut"),e.addEventListener("animationend",(()=>{e.parentNode===document.body&&document.body.removeChild(e),o=!1,document.removeEventListener("keydown",l,!0)}),{once:!0}))},l=e=>{const t=document.getElementById("menu-input"),c=document.getElementById("menu-depth-input"),l=document.getElementById("menu-search-button");120===e.keyCode?(o?r():n(),e.preventDefault()):o&&(e.target===t||e.target===c?(13===e.keyCode&&l.click(),e.stopPropagation()):(e.stopPropagation(),e.preventDefault()))},a=[{componentName:"lightComponent",keyCode:112,depth:17,structure:[{type:"object"},{type:"number"},{type:"boolean"},{type:"boolean"},{type:"boolean"},{type:"boolean"},{type:"object"},{type:"boolean"},{type:"boolean"},{type:"boolean"},{type:"boolean",name:"toggleLight"},{type:"object",name:"shadows"},{type:"object",name:"light"},{type:"object",name:"light1"},{type:"object"},{type:"number"}]},{componentName:"suppliesComponent",keyCode:113,depth:20,structure:[{type:"object",name:"nuclear"},{type:"object",name:"repair"},{type:"object",name:"armor"},{type:"object",name:"damage"},{type:"object",name:"nitro"},{type:"object",name:"mine"},{type:"object",name:"gold"},{type:"object",name:"grenade"},{type:"object"},{type:"object"},{type:"object"},{type:"object"},{type:"null"},{type:"null"},{type:"null"},{type:"null"}]},{componentName:"skyboxComponent",keyCode:114,depth:15,structure:[{type:"object"},{type:"object",name:"skybox"},{type:"object",name:"skybox1"},{type:"string"},{type:"boolean"},{type:"number"},{type:"object"},{type:"object"},{type:"null"},{type:"boolean"},{type:"boolean"},{type:"boolean"},{type:"object"},{type:"boolean"},{type:"null"},{type:"object"},{type:"float32Array"},{type:"float32Array"},{type:"number"},{type:"object"},{type:"object"},{type:"object"},{type:"object"}]}],d=[{pattern:"lightComponent",battle:!0,keyCode:118,child:"12",children:[{child:"number"},{child:"number"},{child:"number",value:-.3}]},{pattern:"lightComponent",battle:!0,keyCode:118,child:"13",children:[{child:"number",value:.87},{child:"number",value:.87},{child:"number",value:.87},{child:"number"}]},{pattern:"lightComponent",battle:!0,keyCode:118,child:"14",children:[{child:"number",value:.87},{child:"number",value:.87},{child:"number",value:.87},{child:"number"}]},{pattern:"lightComponent",battle:!0,keyCode:118,child:"11",value:[{child:"boolean",value:!0}]},{pattern:"lightComponent",keyCode:105,child:"12",children:[{child:"number"},{child:"number"},{child:"number",loopValue:"-0.5/0![0.001](15)"}]},{pattern:"suppliesComponent",keyCode:96,child:"1",children:[{child:"object"},{child:"object"},{child:"number"},{child:"object"},{child:"boolean"},{child:"number",loopValue:"1611(0)"},{child:"object"}]},{pattern:"suppliesComponent",keyCode:96,child:"2",children:[{child:"object"},{child:"object"},{child:"number"},{child:"object"},{child:"boolean"},{child:"number",loopValue:"318000(0)"},{child:"object"}]},{pattern:"suppliesComponent",keyCode:96,child:"3",children:[{child:"object"},{child:"object"},{child:"number"},{child:"object"},{child:"boolean"},{child:"number",loopValue:"402000(0)"},{child:"object"}]},{pattern:"suppliesComponent",keyCode:96,child:"4",children:[{child:"object"},{child:"object"},{child:"number"},{child:"object"},{child:"boolean"},{child:"number",loopValue:"449000(0)"},{child:"object"}]},{pattern:"suppliesComponent",keyCode:96,child:"5",children:[{child:"object"},{child:"object"},{child:"number"},{child:"object"},{child:"boolean"},{child:"number",loopValue:"491000(0)"},{child:"object"}]},{pattern:"suppliesComponent",keyCode:96,child:"6",children:[{child:"object"},{child:"object"},{child:"number"},{child:"object"},{child:"boolean"},{child:"number",loopValue:"1242000(0)"},{child:"object"}]},{pattern:"suppliesComponent",keyCode:96,child:"7",children:[{child:"object"},{child:"object"},{child:"number",loopValue:"1(150)"},{child:"object"},{child:"boolean"},{child:"number",loopValue:"4614(150)"},{child:"object"}]},{pattern:"suppliesComponent",keyCode:96,child:"8",children:[{child:"object"},{child:"object"},{child:"number"},{child:"object"},{child:"boolean"},{child:"number",loopValue:"24018(150)"},{child:"object"}]},{pattern:"skyboxComponent",keyCode:104,child:"2",children:[{child:"number"},{child:"number"},{child:"number",loopValue:"0/100![0.0050](0)"}]}],i=(e,t)=>{const o={components:[],namedComponents:{}},n=new Map;t.structure.forEach((e=>{e.name&&n.set(e.name,e)}));const c=(e,r=0,l=[],a=new Set)=>{if(!(a.has(e)||r>t.depth||"object"!=typeof e||null===e)){a.add(e),((e,t)=>{const o=t.some((e=>"float32Array"===e.type)),n=Object.values(e).map((e=>null===e?"null":o&&e instanceof Float32Array?"float32Array":typeof e));if(n.length!==t.length)return!1;const c={};t.forEach((e=>{c[e.type]=(c[e.type]||0)+1}));const r={};n.forEach((e=>{r[e]=(r[e]||0)+1}));for(let e in c)if(c[e]!==r[e])return!1;return!0})(e,t.structure)&&o.components.push({component:e,path:[...l]});for(let t in e){const d=e[t];if("object"==typeof d&&null!==d){const e=n.get(t);e&&(o.namedComponents[e.name]||(o.namedComponents[e.name]=[]),o.namedComponents[e.name].push({component:d,path:[...l,t]})),c(d,r+1,[...l,t],a)}}}};return c(e),o.components.length>0?(console.groupCollapsed(`%c${t.componentName}`,"color: rgba(32, 255, 0, 1)"),o.components.forEach((({component:e})=>{let o=1;t.structure.forEach((t=>{const n=Object.keys(e)[o-1],c=e[n],r=t.type,l=t.name;let a;a=l?"rgba(255, 181, 0, 1)":"object"===r?"rgba(0, 128, 255, 1)":"boolean"===r?"rgba(255, 128, 0, 1)":"number"===r?"rgba(128, 0, 255, 1)":"inherit",null===c&&"null"===r?console.log(`%c${o} потомок (null):`,`color: ${a}`,c):l?console.log(`%c${o} потомок (${l}):`,`color: ${a}`,c):"object"===r&&"object"==typeof c?console.log(`%c${o} потомок (${r}):`,`color: ${a}`,c):console.log(`%c${o} потомок (${typeof c}):`,`color: ${a}`,c),o++}))})),console.groupEnd()):console.log(`%c${t.componentName} не найден`,"color: rgba(255, 0, 0, 1)"),o},p={paths:{},isValidPath(e,t){let o=e;for(let e of t){if("object"!=typeof o||null===o)return!1;o=o[e]}return!0},getComponentByPath(e,t){let o=e;for(let e of t)o=o[e];return o},clearIfInvalid(e,t){const o=t.componentName;this.paths[o]&&this.paths[o].filter((({path:t})=>!this.isValidPath(e,t))).length>0&&(console.log(`%cкэш очищен для: ${o}`,"color: rgba(255, 0, 0, 1)"),delete this.paths[o])},updateCache(e,t,o){this.paths[t.componentName]=o.map((({path:e})=>({path:e})))},getCachedComponents(e,t){const o=t.componentName;if(this.clearIfInvalid(e,t),this.paths[o]){const t=this.paths[o].filter((({path:t})=>this.isValidPath(e,t)));if(t.length>0)return t.map((({path:t})=>({component:this.getComponentByPath(e,t),path:t})))}return null}},h=()=>{Array.isArray(s)&&(s.forEach((e=>clearTimeout(e))),s.length=0,console.log("%cвсе циклы остановлены","color: rgba(255, 0, 0, 1)"))};let s=[];const u=(e,t)=>{const o=parseInt(t.child)-1,n=Object.values(e)[o],c=Object.keys(e)[o];if(void 0===n)return console.error(`%cпотомок с индексом ${o+1} не найден`,"color: red;"),!1;const r=e=>null!==e&&"object"==typeof e,l=(e,t)=>{if(!r(e))return!1;const o=Object.values(e).map((e=>null===e?"null":typeof e)),n=t.map((e=>e.child)),c=o.reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{}),l=n.reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{});return Object.keys(l).every((e=>l[e]===c[e]))},a=(e,t)=>{t.forEach(((t,o)=>{const n=Object.keys(e)[o],c=e[n];void 0!==c?t.children?r(c)&&l(c,t.children)?a(c,t.children):console.log(`%cструктура потомков не совпадает с ожидаемой для: ${n}`,"color: red;"):t.loopValue?((e,t,o)=>{let n,c=0,r=[];const l=o.match(/^(-?\d+(?:\.\d+)?)\/(-?\d+(?:\.\d+)?)(!)?\[(\d+(?:\.\d+)?)\]\((\d+)\)$/),a=o.match(/^(-?\d+(?:\.\d+)?|\d+)\((\d+)\)$/);if(l){const o=parseFloat(l[1]),a=parseFloat(l[2]),d=!!l[3],i=parseFloat(l[4]);if(n=parseInt(l[5],10),o<=a){for(let e=o;e<=a;e+=i)r.push(e);if(d)for(let e=a;e>=o;e-=i)r.push(e)}else{for(let e=o;e>=a;e-=i)r.push(e);if(d)for(let e=a;e<=o;e+=i)r.push(e)}const p=()=>{if(0===r.length)return;e[t]=r[c],c=(c+1)%r.length;const o=setTimeout(p,n);s.push(o)};p()}else if(a){const o=parseFloat(a[1]);n=parseInt(a[2],10);const c=()=>{e[t]=o;const r=setTimeout(c,n);s.push(r)};c()}else console.error("некорректный формат loopValue:",o);window.addEventListener("keydown",(e=>{106===e.keyCode&&h()}))})(e,n,t.loopValue):void 0!==t.value&&(console.log(`%cизменение потомка (${n}): %c${c} %c→ %c${t.value}`,"color: #3498db;","color: #e74c3c;","color: #2ecc71;","color: #9b59b6;"),e[n]=t.value):console.error(`%cпотомок с ключом ${n} не найден`,"color: red;")}))};return r(n)?t.children&&l(n,t.children)?(a(n,t.children),!0):(console.log(`%cструктура потомков не совпадает с ожидаемой для: ${t.pattern}`,"color: red;"),!1):t.value&&Array.isArray(t.value)?(t.value.forEach((t=>{typeof n===t.child&&(console.log(`%cизменение значений потомка ${c} с: ${n} на: ${t.value}`,"color: rgba(32, 255, 0, 1)"),e[c]=t.value)})),!0):(console.error(`%cнеподдерживаемый формат значения для ${c}`,"color: red;"),!1)};(()=>{const e=document.createElement("style");e.type="text/css",e.innerText="@keyframes fadeIn{from{opacity:0;}to{opacity:1;}}\n        @keyframes fadeOut{from{opacity:1;}to{opacity:0;}}\n        #search-menu-background{animation:fadeIn .5s forwards;}\n        #search-menu-background.fadeOut{animation:fadeOut .5s forwards;}\n        #menu-container{background:rgba(0,0,0,.2);outline:none;padding:1rem;border-radius:1.2rem;border:.150rem solid rgba(255,255,255,.2);box-shadow:0 0 1rem .1rem rgba(0,0,0,.6),inset 0 0 .5rem .15rem rgba(0,0,0,.3);width:50%;text-align:center;display:flex;flex-direction:column;align-items:center;}\n        #menu-header{margin:0;margin-bottom:1rem;color:white;font-size:1.6rem;}\n        #menu-content{display:flex;flex-direction:row;align-items:center;justify-content:center;width:100%;margin-bottom:1rem;}\n        #menu-checkbox-container{display:flex;justify-content:space-around;width:100%;margin:0;margin-bottom:.1rem;flex-wrap:nowrap;}\n        #menu-input{background:transparent;color:white;padding:.5rem;border:.150rem solid rgba(222,184,135,.2);border-radius:1rem;font-size:1rem;margin-bottom:.8rem;width:calc(50% - 1rem);transition:border-color .3s;}\n        #menu-depth-input{background:transparent;color:white;padding:.5rem;border:.150rem solid rgba(222,184,135,.2);border-radius:1rem;font-size:1rem;margin-left:.8rem;margin-bottom:.8rem;width:calc(9%);transition:border-color .3s;}\n        #menu-input:focus,#menu-depth-input:focus{border-color:rgba(255,188,9,.3);outline:none;}\n        #menu-input:hover,#menu-depth-input:hover{border-color:rgba(255,188,9,.3);}\n        #menu-switch-container{display:flex;justify-content:center;align-items:center;margin-top:1rem;width:100%;}\n        #menu-search-button{padding:.5rem 1.5rem;background-color:transparent;color:white;border:.150rem solid rgba(222,184,135,.2);border-radius:1.2rem;font-size:1.2rem;cursor:pointer;transition:background-color .3s,transform .2s;}\n        #menu-search-button:hover{background-color:rgba(255,188,9,.25);}\n        #menu-search-button:active{transform:scale(.95);}\n        .menu-checkbox-wrapper{display:flex;align-items:center;margin-right:.5rem;}\n        .menu-checkbox-wrapper input[type=checkbox]{height:0;width:0;visibility:hidden;}\n        .menu-checkbox-wrapper label{cursor:pointer;width:4rem;height:2rem;background:rgba(222,184,135, .2);backdrop-filter:blur(.5rem);display:block;border-radius:2rem;position:relative;transition:background-color .3s;}\n        .menu-checkbox-wrapper label:after{content:'';position:absolute;top:.2rem;left:.2rem;width:1.6rem;height:1.6rem;background:#fff;border-radius:50%;transition:.3s;}\n        .menu-checkbox-wrapper input:checked+label{background:rgba(255,188,9,.65);}\n        .menu-checkbox-wrapper input:checked+label:after{left:calc(100% - .2rem);transform:translateX(-100%);}\n        .menu-checkbox-wrapper label:active:after{width:2rem;}\n        .menu-checkbox-wrapper span{margin-right:0;font-size:1rem;color:white;}\n        .footer{width:100%;display:flex;justify-content:center;margin-top:1.2rem;}",document.head.appendChild(e)})(),(()=>{let e=!1;const t=new Set;new MutationObserver((o=>{for(let n of o)if("childList"===n.type){const o=document.querySelector(".BattleComponentStyle-canvasContainer");o&&!e?(e=!0,t.clear(),d.forEach((e=>{if(e.battle){const t=a.find((t=>t.componentName===e.pattern));if(t){let o=p.getCachedComponents(root,t);o||(o=i(root,t).components,p.updateCache(root,t,o)),console.log(`%cавтоматическое применение сценария для: ${t.componentName}`,"color: rgba(32, 255, 0, 1)"),o.forEach((({component:t})=>u(t,e)))}}}))):!o&&e&&(h(),e=!1)}})).observe(document.body,{childList:!0,subtree:!0})})(),window.addEventListener("keydown",l,!0),window.addEventListener("keydown",(e=>{((e,t)=>{d.forEach((o=>{if(t.keyCode===o.keyCode){t.preventDefault();const n=a.find((e=>e.componentName===o.pattern));if(n){let t=p.getCachedComponents(e,n);t||(t=i(e,n).components,p.updateCache(e,n,t)),t.length>0?(console.log(`%cприменение сценария для: ${n.componentName}`,"color: rgba(32, 255, 0, 1)"),t.forEach((({component:e})=>{u(e,o)}))):console.log(`%c${n.componentName} недоступен для изменений`,"color: rgba(255, 0, 0, 1)")}}})),a.forEach((o=>{t.keyCode===o.keyCode&&i(e,o)}))})(root,e)}))})();
//# sourceMappingURL=reactInspector.min.js.map